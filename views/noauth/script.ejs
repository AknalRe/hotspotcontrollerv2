<script>
    const currentTime = new Date().getHours();

    function getUcapan() {
        if (currentTime >= 5 && currentTime < 11) {
            return "Selamat Pagi"
        } else if (currentTime >= 11 && currentTime < 15) {
            return "Selamat Siang"
        } else if (currentTime >= 15 && currentTime < 18) {
            return "Selamat Sore"
        } else {
            return "Selamat Malam"
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const usernameElement = document.getElementById('sambutan');

        const ucapan = getUcapan();
        usernameElement.innerText = `${ucapan} !`;
    });

    document.addEventListener('DOMContentLoaded', function () {
        // Mendapatkan URL path
        const path = window.location.pathname;
        // Memecah path menjadi bagian-bagian
        const pathParts = path.split('/');
        // Mendapatkan parameter terakhir
        const authParam = pathParts[pathParts.length - 1];
        
        console.log('Auth parameter:', authParam);
        document.getElementById('tambahAkunForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            // if (!password) {
            //     password = username;
            // }
            if (!username) {
                return toastToast(false, "", "Silakan mengisikan username akun");
            }

            const formData = {
                username: username,
                authlogin: authParam
            }
            fetch('/tambahakunhotspot', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
                .then(response => response.json())
                .then(data => {
                    // console.log(data);
                    toastToast(data.success, data.title, data.successwa == true ? `${data.message} & Berhasil mengirimkan pesan whatsapp` : data.message);
                    if (data.success) {
                        document.getElementById('username').value = '';
                    }
                })
                .catch(error => {
                    console.log('Error:', error);
                });
        });
    })
</script>